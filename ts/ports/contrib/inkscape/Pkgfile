# Description: An open source SVG editor.
# URL: https://www.inkscape.org/
# Maintainer: Danny Rawlins, crux at romster dot me
# Depends on: boehm-gc boost gsl gtkmm poppler-glib popt
# Optional: rtmpdump openldap libexif openjade gtk-doc gtkspell brotli imagemagick-compat

name=inkscape
version=0.92.4
release=1
source=(https://media.inkscape.org/dl/resources/file/$name-$version.tar.bz2
	inkscape-0.92.4-poppler-0.76.0.patch)

build() {
	cd $name-$version

	patch -p1 -i $SRC/inkscape-0.92.4-poppler-0.76.0.patch

	CXXFLAGS+=' -std=c++11'

	./autogen.sh

#	export PKG_CONFIG_PATH='/usr/lib/imagemagick6/pkgconfig'
	export FREETYPE_CONFIG="/usr/bin/pkg-config freetype2"

	./configure \
		--prefix=/usr \
		--with-python \
		--with-perl \
		--enable-lcms \
		--disable-poppler-cairo \
		--disable-strict-build \
		--disable-dependency-tracking

	make
	make DESTDIR=$PKG install

	rm \
		$PKG/usr/share/man/man1/inkscape.??.1 \
		$PKG/usr/share/man/man1/inkscape.zh_TW.1

	rm -r \
		$PKG/usr/share/man/?? \
		$PKG/usr/share/man/zh_TW

	find $PKG/usr/share/inkscape -name README -exec rm -f {} +
	/usr/bin/python -mcompileall $PKG
}
